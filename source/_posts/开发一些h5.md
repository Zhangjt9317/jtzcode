---
title: 开发一些h5
date: 2021-04-26 04:27:26
tags:
---

## 介绍

微信 h5 的开发已经有一段时间了，并且适当的技术栈以及配套设施都已经配齐了，

可以参考阮一峰的文章：http://ruanyifeng.com/blog/2019/12/hybrid-app-concepts.html

### H5 是什么？

手机 app 从表面上看都是同样的东西，就是手机上的应用程序，点击图标就可以运行，但是他们的底层技术不一样，按照开发技术，App 可以分为三大类：

- 原生应用 （native application，native app）
- web 应用 （web application， web app）
- 混合应用（hybrid application，hybrid app）

这三类 app 技术模型都不一样，各有优缺点，企业一般会选择一种作为主流，构建自己的手机 app

**H5**可以理解为混合 app 模型，只不过它特指混合 app 的前端部分。因为混合 App 的前端就是 HTML5 网页，所以简称 H5，这个词是国内独有的，基本上都是前端程序员在用，国外一般直接叫混合 app。

我们需要了解什么是原生 app，什么是 web app，才能了解什么是混合 app。

### 原生应用

原生 App 是专门为特定手机平台开发的应用程序 --> android，iOS。
原生 App 使用与手机操作系统相同的语言。iOS 的原生 App 使用 Objective-C 语言或 Swift 语言，安卓使用 Java 语言或 Kotlin 语言。由于跟底层系统的语言和技术模型一致，所以原生 App 的性能和用户体验都很好。

**优点**：原生 App 的优点主要是两个：（1）较好的性能和体验；（2）可以使用系统的所有硬件和软件 API，比如 GPS、摄像头、麦克风、加速计、通知推送等等，能充分发挥系统的潜力。

**缺点**：原生 App 的缺点主要是成本，每个手机平台都要建立一个独立的开发团队，大公司一般都有 iOS 和安卓两个开发团队。如果出现第三个平台（以前的 Windows Phone，也许将来的华为鸿蒙 OS），就要组建第三个团队，成本就更高。

第二个缺点是，原生 App 使用底层操作系统的语言，都是很重的编译型语言，开发和调试成本相对较高，时间周期长。

第三个缺点是，原生 App 必须下载安装才能使用，只要升级版本，就必须重新下载安装。用户往往不愿意更新版本，厂商被迫不得不长期支持很久以前的旧版本。

### web 应用

Web App 是使用网页做的应用程序，必须在浏览器中使用。 比如，你在浏览器中收发邮件，就是在使用 Web App。

使用网页技术，即 HTML, JavaScript， CSS

**优点**： （1）不需要下载安装，打开浏览器就能使用，而且总是使用最新版本；（2）对于开发者来说，Web App 写起来比较快，调试容易，不需要应用商店的批准就能发布。

**缺点**：（1）首先，浏览器提供的 API（即 Web API）很有限（目前只有相机、GPS、电池等少数几个），大部分系统硬件都不能通过网页访问，也无法直接读取硬盘文件，所以 Web App 无法充分利用平台的硬件。（2）第二个缺点是，网页通过浏览器渲染，性能不如原生 App，不适合做性能要求较高的页面。

**劣势**：

Web App 需要打开浏览器才能使用，这意味着，用户必须记住如何导航到它，要么直接输入网址，要么翻找书签。这使得进入 Web App，远不如原生 App 方便。这点很致命，事实表明，用户偏好原生 App。

谷歌曾经调查了原生 App 和 Web App 各一千个，发现 Web App 可以覆盖更多的用户（1100 万 vs 400 万），但是原生 App 的用户使用时间（188 分钟）远超 Web App（9 分钟）。

Google 作为 web app 的大力推行者，认为 web app 足以满足大多数 app 的需求，但是三大缺陷阻碍了它的推广

- 不能从手机的首屏直接进入。
- 缺乏手机状态栏和锁屏时的通知推送能力。
- 不支持脱机访问（即断网也能使用）

为了解决这些问题，PWA 产生了，它可以把网站缓存在手机里面，供离线时使用，还能在手机首屏生成图标，直接点击进入，并且有通知推送能力，也不带有浏览器的地址栏和状态栏，跟原生 App 的使用体验非常接近。但是，PWA 需要浏览器访问一次网站，才能在首屏生成图标，并且目前 iOS 系统的支持还不够理想，所以还只是一项探索性质的技术，迄今为止缺乏足够的成功案例。

### 混合应用

混合 App （hybrid App）顾名思义就是原生 App 与 Web App 的结合。它的壳是原生 App，但是里面放的是网页。 可以理解成，混合 App 里面隐藏了一个浏览器，用户看到的实际上是这个隐藏浏览器渲染出来的网页。

混合 App 的原生外壳称为"容器"，内部隐藏的浏览器，通常使用系统提供的网页渲染控件（即 WebView 控件），也可以自己内置一个浏览器内核。结构上，混合 App 从上到下分成三层：HTML5 网页层、网页引擎层（本质上是一个隔离的浏览器实例）、容器层。

![hybrid](hybrid.jpg)

不同容器的 API Bridge 是不一样的，为某一个容器写的页面不能放到另一个容器中使用，也无法在浏览器中使用，除非网页脚本做了兼容处理。

容器提供的 API Bridge 必须跟着平台更新。比如，iOS 发了新版本，有了新的硬件 API，容器也必须跟着推出新版的 API Bridge。如果容器没有跟上，开发者为了使用新的硬件，就只能想办法自己来写缺失的 API Bridge。

**优点**：
（1）跨平台

Web 技术是跨平台的，开发者只写一次页面，就能支持多个平台。也就是说，混合 App 只需要一个团队就够了，开发成本较低。

（2）灵活性

混合 App 的灵活性大，很容易集成多种功能。一方面，混合 App 很容易加载外部的 H5 页面，实现 App 的插件结构；另一方面，Web 页面可以方便地调用外部的 Web 服务。

（3）开发方便

Web 页面的调试和构建，远比原生控件简单省时。页面的更新也容易，只要在服务器上发布新版本，触发容器内更新就可以了。另外，Web 开发人员也比较容易招聘，传统的前端程序员可以承担开发任务。

**缺点**：
混合 App 的主要缺点是，由于存在网页引擎的中间层，所以性能比较欠缺，不仅不如原生 App，而且由于 WebView 不是全功能浏览器，可能比 Web App 都要慢一些。

另一个缺点是，由于页面跨平台，就无法使用只有特定平台提供的功能，导致体验不如纯的原生 App。举例来说，早期的时候，安卓有物理的后退按钮，iPhone 没有，页面设计不得不考虑这一点。

## 小程序

所谓小程序，可以看作是针对特定容器的 H5 开发。微信本身是一个容器，开放自己的接口（JSbridge），外部开发者使用规定的语法，编写页面，容器可以动态加载这些页面。

小程序对于微信官方的好处是，扩展了功能和应用场景，吸引外部开发者加入，繁荣了生态。对于外部开发者的好处是，有了流量入口，可以直接调用微信的各种功能（比如支付）。

今天对于 H5 相关概念的介绍，就到这里为止，下一篇文章将介绍 H5 相关开发工具和框架。

## 开发

在这篇文章中我们会开发几种 h5，并且分析源码。
